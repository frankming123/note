# MySQL多实例

<!-- TOC -->

- [MySQL多实例](#mysql多实例)
    - [什么是MySQL多实例](#什么是mysql多实例)
    - [MySQL多实例的作用与问题](#mysql多实例的作用与问题)
    - [MySQL多实例生产应用场景](#mysql多实例生产应用场景)
    - [MySQL多实例常见配置方案](#mysql多实例常见配置方案)
    - [安装多实例MySQL数据库](#安装多实例mysql数据库)

<!-- /TOC -->

## 什么是MySQL多实例

MySQL多实例指在一台机器上开启多个不同的服务端口(如3306,3307),运行多个MySQL服务进程.这些服务进程分别提供不同的服务

这些MySQL多实例共用一套MySQL安装程序,使用不同的配置文件,启动程序,数据文件.在提供服务时,多实例MySQL在逻辑上看来是各自独立的

## MySQL多实例的作用与问题

1. 有效利用服务器资源

    当单个服务器资源有剩余时,可以充分利用剩余的资源提供更多的服务

2. 资源互相抢占问题

    当某个服务实例并发很高或者有慢查询时,整个实例会消耗更多的内存,cpu,磁盘io资源,导致服务器上其它的实例提供服务的质量下降

## MySQL多实例生产应用场景

1. 资金紧张型公司的选择

2. 并发访问不是特别大的业务

3. 门户网站应用MySQL多实例场景

## MySQL多实例常见配置方案

1. 多配置文件部署方案

    针对不同的端口采用不同的配置,启动,数据文件

    例如:

        | -- 3306
        | | -- data //数据文件
        | | -- my.cnf //配置文件
        | \ -- mysql //启动文件
        \ -- 3307
          | -- data
          | -- my.cnf
          | -- mysql

2. 单一配置文件部署方案

    - my.cnf配置文件样例

            [mysqld_multi]
            ...

            [mysqld1]
            ...

            [mysqld2]
            ...

    - 启动方法

        mysqld_multi --config-file=my_multi.cnf start 1 2

    - 缺点

        耦合度过高.一般不采用

## 安装多实例MySQL数据库

1. 前提条件

    在官网下载MySQL安装包,下载二进制包并解压缩

2. 建立MySQL账号

        ]# groupadd mysql
        ]# useradd -s /sbin/nologin -g mysql -M mysql

3. 创建MySQL多实例的数据文件目录

    一般采用/data目录作为mysql多实例总的根目录,然后规划不同的MySQL实例端口号作为二级目录